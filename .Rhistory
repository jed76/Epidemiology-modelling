library(dplyr)
library(ggplot2)
library(cowplot)
n <- 1000
seq <- seq(from = 0.05, to = 1.5, by = 0.05)
seq <- seq(from = 0.00, to = 0.95, by = 0.05)
seq <- seq(from = 0.00, to = 0.95, by = 0.05)
confidence_threshold <- 0.005
data <- read.csv("Data/extinctionSamples2.csv") %>%
mutate(mean = rowMeans(.)) %>%
rowwise() %>%
mutate(sd = sd(as.matrix(c_across(1:n)))) %>%
ungroup() %>%
mutate(se = sd / sqrt(n),
ci = qt(1 - (confidence_threshold / 2), n - 1) * se)
n <- 10
data <- read.csv("Data/extinctionSamples2.csv") %>%
mutate(mean = rowMeans(.)) %>%
rowwise() %>%
mutate(sd = sd(as.matrix(c_across(1:n)))) %>%
ungroup() %>%
mutate(se = sd / sqrt(n),
ci = qt(1 - (confidence_threshold / 2), n - 1) * se)
View(data)
data$seq <- seq
p <- ggplot(data) +
geom_line(aes(x = seq, y = mean, colour = "mean")) +
geom_ribbon(aes(x = seq, ymax = mean + ci, ymin = mean - ci, fill = "99.5% CI"), alpha = 0.3) +
theme_cowplot() +
labs(y = "Probability of extinction",
x = "Hosts / unit area") +
theme(
legend.title = element_blank()
)
p
p <- ggplot(data) +
geom_line(aes(x = seq, y = mean, colour = "mean")) +
geom_ribbon(aes(x = seq, ymax = mean + ci, ymin = mean - ci, fill = "99.5% CI"), alpha = 0.3) +
theme_cowplot() +
labs(y = "Probability of extinction",
x = "Proportion of host populations lost") +
theme(
legend.title = element_blank()
)
p
confidence_threshold <- 0.05
data <- read.csv("Data/extinctionSamples2.csv") %>%
mutate(mean = rowMeans(.)) %>%
rowwise() %>%
mutate(sd = sd(as.matrix(c_across(1:n)))) %>%
ungroup() %>%
mutate(se = sd / sqrt(n),
ci = qt(1 - (confidence_threshold / 2), n - 1) * se)
data$seq <- seq
p <- ggplot(data) +
geom_line(aes(x = seq, y = mean, colour = "mean")) +
geom_ribbon(aes(x = seq, ymax = mean + ci, ymin = mean - ci, fill = "95% CI"), alpha = 0.3) +
theme_cowplot() +
labs(y = "Probability of extinction",
x = "Proportion of host populations lost") +
theme(
legend.title = element_blank()
)
p
png("Figures/Host density and extinction 2.png", width = 1000, height = 600, res = 200)
p
dev.off()
p <- ggplot(data) +
geom_line(aes(x = seq, y = mean, colour = "mean")) +
geom_ribbon(aes(x = seq, ymax = mean + ci, ymin = mean - ci, fill = "95% CI"), alpha = 0.3) +
theme_cowplot() +
labs(y = "Probability of extinction",
x = "Proportion of host populations lost") +
lims(y = c(0,1)) +
theme(
legend.title = element_blank()
)
p
p <- ggplot(data) +
geom_line(aes(x = seq, y = mean, colour = "mean")) +
geom_ribbon(aes(x = seq, ymax = mean + ci, ymin = mean - ci, fill = "95% CI"), alpha = 0.3) +
theme_cowplot() +
labs(y = "Probability of extinction",
x = "Proportion of host populations lost") +
# lims(y = c(0,1)) +
theme(
legend.title = element_blank()
)
p
p <- ggplot(data) +
geom_line(aes(x = seq, y = mean, colour = "mean")) +
geom_ribbon(aes(x = seq, ymax = mean + ci, ymin = mean - ci, fill = "95% CI"), alpha = 0.3) +
theme_cowplot() +
labs(y = "Probability of extinction",
x = "Proportion of host populations lost") +
lims(
# y = c(0,1),
x = c(0,1),
) +
theme(
legend.title = element_blank()
)
p
png("Figures/Host density and extinction 2.png", width = 1000, height = 600, res = 200)
p
dev.off()
